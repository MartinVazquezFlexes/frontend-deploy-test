@use "sass:color";
@use "sass:list";
@use 'variables' as *;

// Tamaños mínimos
$sizes: (
  "ultra-small": (8px, 0, 14px, 36px, 36px),
  "small": (4px 8px, 10px, 10px),
  "medium": (6px 16px, 14px, 10px),
  "medium-more-width": (6px 16px, 14px, 10px, 100px, 36px),
  "large": (8px 30px, 16px, 10px),
  "square": (10px, 16px, 10px, 40px),
  "ultra-large": (12px 16px, 18px, 10px, 100%, 48px),
  "ultra-large-minor-height": (12px 16px, 18px, 10px, 100%, 36px),
  "navbar-filter-square": (10px, 0, 10px, 52px, 52px),
);

// Colores base
$colors: (
  "default": $color-default,
  "success": $color-green,
  "error": $color-error,
  "warning": $color-warning,
  "info": $color-info,
  "dark": $color-dark,
  "green": $color-green,
  "red": $color-red,
  "gray": $color-button-placeholder,
  "login": $color-default-hover
);

.btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  border-radius: $radius-base;
  transition: all $transition-base;
  cursor: pointer;
  border: 1px solid transparent;
  box-sizing: border-box;

  &__spinner {
    display: inline-block;
    border-radius: 50%;
    border: 2px solid currentColor;
    border-top-color: transparent;
    animation: spin 0.8s linear infinite;
    flex-shrink: 0;
  }

  // Tamaños
  @each $size, $props in $sizes {
    &--#{$size} {
      padding: list.nth($props, 1);
      font-size: list.nth($props, 2);
      @if list.length($props) > 3 { 
        width: list.nth($props, 4); 
        @if list.nth($props, 4) == 100% {
          max-width: 368px;
          min-width: 280px;
        }
      }
      @if list.length($props) > 4 { height: list.nth($props, 5); }
      @if list.nth($props, 2) == 0 and list.length($props) > 3 { min-width: list.nth($props, 4); }
      .btn__spinner {
        @if list.length($props) > 2 {
          width: list.nth($props, 3);
          height: list.nth($props, 3);
        }
      }

      // Responsive adjustments for ultra-large buttons
      @if $size == "ultra-large" or $size == "ultra-large-minor-height" {
        @media (max-width: 768px) {
          padding: 10px 12px;
          font-size: 16px;
          max-width: 100%;
          min-width: 260px;
        }

        @media (max-width: 480px) {
          padding: 8px 10px;
          font-size: 14px;
          min-width: 240px;
        }
      }
    }
  }

  // Colores y variantes
  @each $color-name, $base-color in $colors {
    &--#{$color-name} {
      &.btn--primary {
        background-color: $base-color;
        color: $color-gray-100;
        &:hover:not(:disabled) { background-color: color.scale($base-color, $lightness: 30%); }
        &:active:not(:disabled) { background-color: color.scale($base-color, $lightness: -30%); }
        &:disabled { background-color: rgba($base-color, 0.3); }
      }
      &.btn--secondary {
        background-color: color.scale($base-color, $lightness: 80%);
        color: $base-color;
        &:hover:not(:disabled) { border-color: color.scale($base-color, $lightness: 30%); }
        &:active:not(:disabled) { border-color: color.scale($base-color, $lightness: -30%); }
        &:disabled { border-color: rgba($base-color, 0.3); }
      }
      &.btn--outline {
        background-color: transparent;
        color: $base-color;
        border-color: $base-color;
        &:hover:not(:disabled) { border-color: color.scale($base-color, $lightness: 30%); color: color.scale($base-color, $lightness: 30%); }
        &:active:not(:disabled) { color: color.scale($base-color, $lightness: -30%); background-color: rgba($base-color, 0.1); }
        &:disabled { border-color: rgba($base-color, 0.3); color: rgba($base-color, 0.3); }
      }
      &.btn--ghost {
        background-color: transparent;
        color: $base-color;
        &:hover:not(:disabled) { background-color: rgba($base-color, 0.05); }
        &:active:not(:disabled) { background-color: rgba($base-color, 0.1); }
        &:disabled { color: rgba($base-color, 0.3); }
      }
    }
  }

  &--loading { cursor: not-allowed; opacity: 0.9; }
  &--disabled { cursor: not-allowed; opacity: 0.7; }
  &--navbar-filter-medium { 
    width: 100px; 
    height: 52px;
    
    @media (max-width: 768px) {
      width: 80px;
      height: 48px;
    }
  }
  &.bg--white { background-color: #ffffff; }
  &.btn--gray { border-color: $color-gray-200; }
  &.btn--no-border { border: none; }
}

@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}
